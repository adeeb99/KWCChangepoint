<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Multisample hypothesis test for difference in covariance operators — fkwc_multisample • KWCChangepoint</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multisample hypothesis test for difference in covariance operators — fkwc_multisample"><meta name="description" content="Executes a multisample hypothesis test for differences in covariance
operators using functional Kruskal–Wallis tests for covariance (FKWC) as
outlined by Ramsay and Chenouri (2024). The function requires the first order
derivative of the functional data in order to better detect changes."><meta property="og:description" content="Executes a multisample hypothesis test for differences in covariance
operators using functional Kruskal–Wallis tests for covariance (FKWC) as
outlined by Ramsay and Chenouri (2024). The function requires the first order
derivative of the functional data in order to better detect changes."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">KWCChangepoint</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/adeeb99/KWCChangepoint/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Multisample hypothesis test for difference in covariance operators</h1>
      <small class="dont-index">Source: <a href="https://github.com/adeeb99/KWCChangepoint/blob/v0.2.3/R/FKWC.R" class="external-link"><code>R/FKWC.R</code></a></small>
      <div class="d-none name"><code>FKWC_multisample.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Executes a multisample hypothesis test for differences in covariance
operators using functional Kruskal–Wallis tests for covariance (FKWC) as
outlined by Ramsay and Chenouri (2024). The function requires the first order
derivative of the functional data in order to better detect changes.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fkwc_multisample</span><span class="op">(</span><span class="va">data</span>, <span class="va">derivs</span>, <span class="va">g</span>, p <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Functional data in <code>matrix</code> or <code>data.frame</code> form, where each row
is an observation/function and the columns are the grid.</p></dd>


<dt id="arg-derivs">derivs<a class="anchor" aria-label="anchor" href="#arg-derivs"></a></dt>
<dd><p>First order derivative of the functional data in <code>matrix</code> or
<code>data.frame</code> form.</p></dd>


<dt id="arg-g">g<a class="anchor" aria-label="anchor" href="#arg-g"></a></dt>
<dd><p>A <code>factor</code> object that indicates which sample each row of data
belongs to.</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>Number of random projections to be generated in order to compute
random projection depths of the data.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list consisting of:</p><ul><li><p><code>$statistic</code> : The observed test statistic.</p></li>
<li><p><code>$pvalue</code> : The p-value based on the null distribution.</p></li>
<li><p><code>$method</code> : A <code>string</code> <code>"FKWC"</code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Ramsay, K., &amp; Chenouri, S. (2024). Robust nonparametric
hypothesis tests for differences in the covariance structure of functional
data. Canadian Journal of Statistics, 52 (1), 43–78.
https://doi.org/10.1002/cjs.11767</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://moviedo5.github.io/fda.usc/reference/fdata.deriv.html" class="external-link">fda.usc::fdata.deriv()</a></code>: for approximating the first order
derivative if unavailable.</p>
<p><code><a href="FKWC_posthoc.html">fkwc_posthoc()</a></code>: for a post-hoc version of this test</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">111</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Generating three sets of Brownian curves with different kernels, each</span></span></span>
<span class="r-in"><span><span class="co">### kernel generating 20 observations</span></span></span>
<span class="r-in"><span><span class="co"># Brownian process 1</span></span></span>
<span class="r-in"><span><span class="va">fd1</span> <span class="op">&lt;-</span> <span class="fu">fda.usc</span><span class="fu">::</span><span class="fu"><a href="https://moviedo5.github.io/fda.usc/reference/rproc2fdata.html" class="external-link">rproc2fdata</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span>, t <span class="op">=</span> <span class="va">t</span>, sigma <span class="op">=</span> <span class="st">"brownian"</span>,</span></span>
<span class="r-in"><span>                           par.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">10</span>, theta <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fd1_d</span> <span class="op">&lt;-</span> <span class="fu">fda.usc</span><span class="fu">::</span><span class="fu"><a href="https://moviedo5.github.io/fda.usc/reference/fdata.deriv.html" class="external-link">fdata.deriv</a></span><span class="op">(</span><span class="va">fd1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Brownian process 2</span></span></span>
<span class="r-in"><span><span class="va">fd2</span> <span class="op">&lt;-</span> <span class="fu">fda.usc</span><span class="fu">::</span><span class="fu"><a href="https://moviedo5.github.io/fda.usc/reference/rproc2fdata.html" class="external-link">rproc2fdata</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span>, t <span class="op">=</span> <span class="va">t</span>, sigma <span class="op">=</span> <span class="st">"brownian"</span>,</span></span>
<span class="r-in"><span>                           par.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">1</span>, theta <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fd2_d</span> <span class="op">&lt;-</span> <span class="fu">fda.usc</span><span class="fu">::</span><span class="fu"><a href="https://moviedo5.github.io/fda.usc/reference/fdata.deriv.html" class="external-link">fdata.deriv</a></span><span class="op">(</span><span class="va">fd2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Brownian process 3</span></span></span>
<span class="r-in"><span><span class="va">fd3</span> <span class="op">&lt;-</span> <span class="fu">fda.usc</span><span class="fu">::</span><span class="fu"><a href="https://moviedo5.github.io/fda.usc/reference/rproc2fdata.html" class="external-link">rproc2fdata</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span>, t <span class="op">=</span> <span class="va">t</span>, sigma <span class="op">=</span> <span class="st">"brownian"</span>,</span></span>
<span class="r-in"><span>                           par.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">1</span>, theta <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fd3_d</span> <span class="op">&lt;-</span> <span class="fu">fda.usc</span><span class="fu">::</span><span class="fu"><a href="https://moviedo5.github.io/fda.usc/reference/fdata.deriv.html" class="external-link">fdata.deriv</a></span><span class="op">(</span><span class="va">fd3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Functional data in one matrix and first order derivatives in another matrix</span></span></span>
<span class="r-in"><span><span class="va">funcdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">fd1</span><span class="op">$</span><span class="va">data</span>, <span class="va">fd2</span><span class="op">$</span><span class="va">data</span>, <span class="va">fd3</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">funcderivs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">fd1_d</span><span class="op">$</span><span class="va">data</span>, <span class="va">fd2_d</span><span class="op">$</span><span class="va">data</span>, <span class="va">fd3_d</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">fkwc_multisample</span><span class="op">(</span>data <span class="op">=</span> <span class="va">funcdata</span>,</span></span>
<span class="r-in"><span>                 derivs <span class="op">=</span> <span class="va">funcderivs</span>,</span></span>
<span class="r-in"><span>                 g <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, each <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 p <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $statistic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 38.56262</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pvalue</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4.228953e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "FKWC multi-sample hypothesis test"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adeeb Rouhani, Kelly Ramsay.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

